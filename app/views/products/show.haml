.container-fluid
	%h1 #{@product.name}

	- if @product.uploads.attached?
		.row.slider
			- @product.uploads.each do |u|
				= image_tag(u.variant(resize: '300!x200').processed)

	- if user_signed_in?
		.container-fluid
			.row
				=link_to "Add Photos", new_product_upload_path(@product), class: 'btn btn-primary'

	- if has_reviews?
		- rating_average(@product.reviews).round.times do
			= image_tag('butcher.svg', class: 'svg')
		- (5 - rating_average(@product.reviews).round).times do
			= image_tag('butcher_blank.svg', class: 'svg')
		%span / #{@product.reviews.length} reviews
	- else
		%p This cereal currently has no reviews.

	- if user_signed_in? && !left_review?
		%div= link_to "Write a Review", new_product_review_path(@product), class: "btn btn-primary"


	- if has_reviews?
		.container-fluid
			.row
				%h2 Reviews
			- @product.reviews.each do |r|
				.row.reviews
					.col-3
						%h3= link_to r.user.username, user_path
						- if r.user.avatar.present?
							= image_tag(r.user.thumbnail, class:"img-fluid")
					.col-9
						.row
							.col
								%div= r.created_at.strftime("%m/%d/%Y")
								= image_tag("#{r.rating}star.png")
						.row
							.col.comment
								%p= r.comment
					- if user_signed_in? && owns_review?(r)
						= link_to "Edit", edit_product_review_path(@product, r), class: "btn btn-primary"
						= link_to "Delete", product_review_path(@product, r), :data => {:confirm => 'Are you sure you want to delete your review?'}, :method => :delete, class: "btn btn-danger"