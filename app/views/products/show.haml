.container-fluid
	%h1 #{@product.name}

	- if has_reviews?
		= rating_average(@product.reviews)
		%p #{@product.reviews.length} reviews
	- else
		%p This cereal currently has no reviews.

	- if user_signed_in? && !left_review?
		= link_to "Add Review", new_product_review_path(@product), class: "btn btn-primary"

	- if @product.uploads.attached?
		.row
			- @product.uploads.each do |u|
				= image_tag(u.variant(resize: '300x300!').processed)

	- if has_reviews?
		.container-fluid
			- @product.reviews.each do |r|
				.row
					.col-3
						%p= link_to r.user.username, user_path
						- if r.user.avatar.present?
							= image_tag(r.user.thumbnail, class:"img-fluid")
					.col-9
						.row
							.col
								%p= r.rating
								%p= r.created_at.strftime("%b %-d %Y")
						.row
							.col
								%p= r.comment
				- if user_signed_in? && owns_review?(r)
					= link_to "Edit", edit_product_review_path(@product, r), class: "btn btn-primary"
					= link_to "Delete", product_review_path(@product, r), :data => {:confirm => 'Are you sure you want to delete your review?'}, :method => :delete, class: "btn btn-danger"

